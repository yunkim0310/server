<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>예약 목록</title>

  <link rel="stylesheet" th:href="@{/css/template/style.css}">

  <style>
    .container {
      margin: 0 auto;
      width: 1400px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* 검색 폼을 예약 카드 위에 맞춤 */
    .rsrvstatus-table {
      width: 100%;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px; /* 예약 카드와의 간격 */
    }

    .pl {
      width: 180px;
      border: 1px solid #C4C4C4;
      box-sizing: border-box;
      border-radius: 10px;
      padding: 5px 13px;
      font-family: 'Roboto';
      font-style: normal;
      font-weight: 400;
      font-size: 14px;
      line-height: 16px;
      text-align: center;
      height: 30px;
    }

    .search-button {
      height: 30px;
      padding: 5px 15px;
      border-radius: 10px;
      border: 1px solid #C4C4C4;
      background-color: #FFF;
      font-size: 14px;
      cursor: pointer;
    }

    .reservation-list {
      display: flex;
      flex-direction: column;
      gap: 20px;
      padding: 20px;
    }

    .reservation-item {
      border: 1px solid #C4C4C4;
      border-radius: 10px;
      padding: 20px;
      background-color: #F8F8F8;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      width: 500px;
      max-width: 100%;
    }

    .reservation-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .reservation-header .reservation-date {
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }

    .reservation-header .reservation-number {
      font-size: 16px;
      color: #888;
      text-align: right;
    }

    .reservation-body p {
      margin: 10px 0;
      font-size: 16px;
      color: #555;
    }

    .reservation-status {
      display: flex;
      justify-content: space-between; /* 좌우로 정렬 */
      align-items: center; /* 세로 정렬 */
      margin: 10px 0;
      font-size: 16px;
      font-weight: bold;
      color: #333;
    }


    .review-button {
      background-color: #FF8080;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 8px 15px;
      font-size: 14px;
      cursor: pointer;
      display: block;
    }

    .review-button:hover {
      background-color: #E04E4E;
    }

    .status-actions {
      display: flex;
      align-items: center;
      min-height: 40px; /* 버튼이 없어도 일정한 공간 유지 */
    }

  </style>
</head>
<body>
<h1>예약 목록</h1>

<div class="container">
  <!-- 검색 폼 -->
  <form id="searchForm" action="/test/reservation/getRsrvUserList" method="POST" class="rsrvstatus-table">
    <!-- 예약 상태 -->
    <!-- 유저 이름 (필수) -->
    <input type="hidden" name="userName" th:value="${param.userName}" />

    <select id="searchKeyword" name="searchKeyword" class="pl">
      <option value="" th:selected="${param.searchKeyword == null}">모든 상태</option>
      <option value="예약 요청" th:selected="${param.searchKeyword =='예약 요청'}">예약 요청</option>
      <option value="예약 확정" th:selected="${param.searchKeyword =='예약 확정'}">예약 확정</option>
      <option value="이용 완료" th:selected="${param.searchKeyword =='이용 완료'}">이용 완료</option>
      <option value="리뷰 완료" th:selected="${param.searchKeyword =='리뷰 완료'}">리뷰 완료</option>
      <option value="예약 취소" th:selected="${param.searchKeyword =='예약 취소'}">예약 취소</option>
      <option value="예약 거절" th:selected="${param.searchKeyword =='예약 거절'}">예약 거절</option>
    </select>

    <!-- 정렬 방식 -->
    <select id="order" name="order" class="pl">
      <option value="desc" th:selected="${param.order == 'desc'}">내림차순</option>
      <option value="asc" th:selected="${param.order == 'asc'}">오름차순</option>
    </select>

    <!-- 검색 버튼 -->
    <button type="submit" class="search-button">Search</button>
  </form>

  <!-- 예약 리스트 -->
  <div class="reservation-list">
    <table>
      <!-- 예약 카드 -->
      <div class="reservation-item" th:each="reservation : ${reservations}"><!-- 헤더 -->
        <div class="reservation-header">
          <span class="reservation-date" th:text="${#dates.format(reservation.rsrvDt, 'yyyy.MM.dd')}"/>
          <span class="reservation-number" th:text="${reservation.rsrvNo}"/>
        </div>

        <!-- 본문 -->
        <div class="reservation-body">
          <p><strong>예약 시간</strong> <span th:text="${#dates.format(reservation.rsrvDt, 'HH:mm')}"/></p>
          <p><strong>매장명</strong> <span th:text="${reservation.storeName}"/></p>
          <p><strong>전화 번호</strong> <span th:text="${reservation.rsrvNumber}"/></p>
          <p><strong>예약 인수</strong> <span th:text="${reservation.rsrvPerson}"/>명</p>
        </div>

        <!-- 상태 -->
        <div class="reservation-status">
          <span th:text="${reservation.rsrvStatus}"/>
          <!-- 리뷰 작성 버튼 -->
          <div class="status-actions">
            <button class="review-button" th:if="${reservation.rsrvStatus == '예약 확정'}" th:text="'리뷰 작성'"></button>
          </div>
        </div>
      </div>
    </table>
  </div>
</div>
</body>
</html>