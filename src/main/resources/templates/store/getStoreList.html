<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>PlaceHere</title>

        <link rel="stylesheet" href="/css/templates/style.css">
    <!--    <link rel="stylesheet" href="/css/templates/notice.css">-->

        <script defer type="text/javascript" src="/javascript/templates/script.js"></script>

        <link th:insert="~{common/import :: importFragment}">

        <!-- 검색, 필터 관련 -->
        <link rel="stylesheet" href="/css/templates/collection_detail.css">
        <link rel="stylesheet" href="/css/templates/regist_hp.css">
        <link rel="stylesheet" href="/css/store/modalStoreFilter.css">
        <script src="/javascript/store/modalStoreFilter.js"></script>
        <script type="module" src="/javascript/store/searchStore.js"></script>

        <!-- 구글 지도 -->
        <script defer th:src="'https://maps.googleapis.com/maps/api/js?key='+${googleApi}+'&loading=async&callback=initMap&libraries=map,marker'"></script>

        <script src="/javascript/store/getStoreList.js"></script>
        <link rel="stylesheet" href="/css/store/getStoreList.css">

    </head>

    <body>

        <input type="hidden" name="storeLocationList" th:value="${storeLocationList}">

        <div id="root">

            <div class="wrapper" style="max-width: 90%;margin: 0 auto;width: auto;position: relative;background: #fff;min-height: 100%;">

                <main id="main" style="padding-bottom: 0px;">

                    <div class="layout-container" style="display: flex; flex-direction: row; justify-content: space-between;">

                        <div id="map-container" style="flex: 1; max-width: 60%; margin-right: 20px;">
                            <div th:insert="~{store/searchStore :: searchStoreFragment}"></div>
                            <div id="map" style="width: 100%; height: 600px; background-color: #e0e0e0;">

                                <p style="text-align: center; line-height: 600px; color: #555;">지도가 표시됩니다.</p>
                            </div>
                        </div>

                        <div id="store-list-container" style="flex: 2;">

                            <div class="search-header __autohide" style="background: none; top: 48px;">

                                <div class="__search-result-header mb-20">
                                    <div class="__total-count" style="min-width: 121px">
                                        <strong th:text="|총 ${totalCnt}개의 매장|">104</strong>
                                    </div>
                                </div>

                            </div>

                            <!-- 가게 목록 -->
                            <section class="section">
                                <div class="container gutter-sm">
                                    <div class="saved-restaurant-list">
                                        <div style="padding-bottom: 10px;">
                                            <div id="searchList_">
                                                <div id="searchList__0" data-dummy="40">
                                                    <div th:if="${totalCnt == 0}" style="text-align: center">
                                                        <span>검색된 매장이 없습니다.</span>
                                                    </div>
                                                    <div th:each="store : ${storeList}">
                                                        <div class="saved-restaurant-list-item" style="padding-bottom: 40px;">
                                                            <div class="restaurant-info">
                                                                <div class="tb">
                                                                    <a th:href="'/getStore?storeId='+${store.storeId}">
                                                                        <img class="img" style="height: 180px;width: 150px;"
                                                                             th:src="${(store.storeImg1.indexOf('_') != -1)? '/images/store/store/'+store.storeImg1 : url + store.storeImg1}">
                                                                    </a>
                                                                </div>
                                                                <div id="toast"></div>
                                                                <div class="detail">
                                                                    <div class="detail-header">
                                                                        <div class="txt">
                                                                            <div style="display:flex; justify-content: space-between;">
                                                                                <a th:href="'/getStore?storeId='+${store.storeId}">
                                                                                    <h4 class="name" th:text=" ${store.storeName}">
                                                                                        매장명
                                                                                    </h4>
                                                                                </a>

                                                                                <div class="timetable-list timetable-list-sm">
                                                                                    <a class="timetable-list-item" th:href="'/reservation/addRsrv?storeId='+${store.storeId}"
                                                                                       style="margin-bottom: auto; margin-top: 12px; min-width: 70px;">
                                                                                        <span class="time">예약하기</span>
                                                                                    </a>
                                                                                </div>
                                                                            </div>

                                                                            <p class="excerpt" style="font-size: 13px;line-height: 15px;color: #000;" th:text=" ${store.storeAddr}">매장 주소</p>

                                                                        </div>

                                                                    </div>

                                                                    <div class="restaurant-meta">
                                                                        <div class="__d-flex mb-6">
                                                                            <div class="rating" style="display: flex;margin-bottom: 8px;align-items: baseline;">
                                                                                <span class="star" style="top:0px;font-size: 18px;position: relative;padding-left: 18px;display: inline-block;vertical-align: middle;font-weight: 700;color: black"
                                                                                      th:text="'&ensp;'+${store.reviewScoreAvg}">리뷰 평균</span>&nbsp;
                                                                                <span class="count" style="vertical-align: middle;font-size: 15px;margin-left: 5px;color: #999;font-weight: 400;"
                                                                                      th:text="|(${store.reviewCnt})|">리뷰개수</span>&ensp;
                                                                                <span class="tags" style="display: block;color: #aaa;margin-bottom: 5px;font-size: 15px;"
                                                                                      th:text=" ${(store.storeAddr.split(' ')[1])+ '&ensp;|&ensp;' + (store.foodCategoryId.split('/')[0]+'&ensp;'+((store.foodCategoryId.split('/').length>3) ? store.foodCategoryId.split('/')[3] : ''))}">음식 카테고리</span>
                                                                            </div>
                                                                        </div>

                                                                        <span class="price" style="display: flex;font-size: 17px;align-items: center;color: black;padding: 5px"
                                                                              th:text="${store.menuList[store.specialMenuNo -1].menuName + ' ('+store.menuList[store.specialMenuNo -1].menuPrice+' 원)'}">
                                                                        </span>

                                                                        <span class="hashtag" style="display: inline-flex;font-size: 17px;align-items: center;color: black; padding: 5px;padding-top: 0px"
                                                                              th:each="hashtag : ${store.hashtagList}">
                                                                            <a th:text="'#'+${hashtag}" th:attr="href='/getStoreList?mode=search&searchKeyword=&foodCategoryId=&priceMin=0&priceMax=100000&hashtagList='+${hashtag}">#해시태그</a>&ensp;
                                                                        </span>

                                                                    </div>

                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!--페이징 처리-->
                                <th:block th:insert="~{common/paging :: pagingFragment}"></th:block>
                                <form name="paging">
                                    <input type="hidden" name="page">
                                </form>
                                <!--페이징 끝-->

                            </section>
                        </div>

                    </div>

                </main>

            </div>

        </div>

    </body>

</html>